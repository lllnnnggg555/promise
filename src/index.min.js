"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function handleResolve(e){for(this.status="fulfilled",this.value=e;this.onResolveCallback.length;)this.onResolveCallback.shift()()}function resolve(e){var t=handleResolve.bind(this),n=reject.bind(this);"panding"===this.status&&resolveExecutor(null,e,t,n)}function reject(e){if("panding"===this.status)for(this.status="rejected",this.reason=e;this.onRejectCallback.length;)this.onRejectCallback.shift()()}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Promise=function(){function e(t){_classCallCheck(this,e),this.status="panding",this.value=void 0,this.reason=void 0,this.onResolveCallback=[],this.onRejectCallback=[];try{t(resolve.bind(this),reject.bind(this))}catch(e){reject(e)}}return _createClass(e,[{key:"then",value:function(t,n){var o=this,i=function(e,t,n,o,i,r){try{if("function"==typeof t){var u=t(n);resolveExecutor(e,u,o,i)}else r?o(n):i(n)}catch(e){i(e)}};if("fulfilled"===this.status){var r=new e(function(e,n){setTimeout(function(){i(r,t,o.value,e,n,!0)})});return r}if("rejected"===this.status){var u=new e(function(e,t){setTimeout(function(){i(u,n,o.reason,e,t)})});return u}if("panding"===this.status){var s=new e(function(e,r){o.onResolveCallback.push(function(){setTimeout(function(){i(s,t,o.value,e,r,!0)})}),o.onRejectCallback.push(function(){setTimeout(function(){i(s,n,o.reason,e,r)})})});return s}}},{key:"catch",value:function(e){return this.then(null,e)}}],[{key:"resolve",value:function(t){return new e(function(e){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"all",value:function(t){return new e(function(e,n){for(var o=t.length,i=[];t.length;)t.shift().then(function(t){i.push(t),i.length===o&&e(i)})})}},{key:"race",value:function(t){return new e(function(e,n){for(;t.length;)t.shift().then(function(t){return t?e(t):null})})}}]),e}();exports.default=Promise;var resolveExecutor=function e(t,n,o,i){if(n instanceof Promise){if(t===n)return i(new TypeError("不能循环引用"));n.then(o,i)}else if(null===n||"object"!==("undefined"==typeof n?"undefined":_typeof(n))&&"function"!=typeof n)o(n);else{var r=void 0;try{r=n.then}catch(e){i(e)}if("function"==typeof r){var u=!1,s=function(n){!u&&e(t,n,o,i),u=u===!1},l=function(e){!u&&i(e),u=u===!1};try{r.call(n,s,l)}catch(e){!u&&i(e),u=u===!1}}else o(n)}};module.exports=exports.default;